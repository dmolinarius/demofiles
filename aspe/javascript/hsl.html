<!DOCTYPE html>

<html lang="fr">
<meta charset="utf-8">
<title>Solution tableaux hsl</title>

<style>
 body { font-family: Consolas, monospace; }
 h1 { font-size: 120%; color: #80c0ff; font-family: Calibri, sans-serif;}
 b { color: orange; }
 table.hsl {
  width: auto;
  margin-left: auto;
  margin-right: auto;
  background-color: #A0A0A0;
  border-width: 2px 10px 10px 2px;
  border-style: solid;
  border-color: #A0A0A0;
  border-collapse: collapse;
  line-height: 1.33em;
 }
 table.hsl td {
  border: 1px solid #A0A0A0;
  padding: 0.1em 0.2em;
  color: black;
  font-family: Consolas, monospace;
  width: 3em;
  background-color: #C0C0C0;
 }
 table.hsl tr:first-child td,
 table.hsl tr:nth-child(2) td {
  text-align: center;
  background-color: transparent;
 }
 table.hsl td:first-child {
  text-align: right;
  background-color: transparent;
 }

 #slider {
  position: absolute;
  border: 1px solid black;
  background-color: white;
  width: 10px;
  cursor: default;
  top: -2px;
  box-shadow: 2px 2px 2px black;
  border-radius: 3px;
 }
</style>

<body>

 <h1>1. - tableau HSL</h1>
 <table id="hsl1" class="hsl">
  <tr><td> </td><td colspan=5>saturation</td></tr>
  <tr><td>lum</td><td>100%</td><td>75%</td><td>50%</td><td>25%</td><td>0%</td></tr>
  <tr><td>100%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>87.50%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>75%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>62.5%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>50%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>37.5%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>25%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>12.5%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>0%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
 </table>
 <script>
   var table = document.getElementById('hsl1');    // table concernée
   var rows = table.getElementsByTagName('TR');    // lignes de la table
   for ( var n = 2; n < rows.length; n++ ) {       // boucle sur les lignes
     tr = rows[n];                                 // ligne courante
     var lum = tr.firstChild.firstChild.nodeValue; // lum = texte 1ère cellule
     var satNode = rows[1].firstChild.nextSibling; // sat = 2ème cellule 2ème ligne
     for ( var td = tr.childNodes[1]; td; td = td.nextSibling ) {
       var couleur = 'hsl(0,'+satNode.firstChild.nodeValue+','+lum+')';
       td.style.backgroundColor = couleur;         // couleur de la cellule
       td.setAttribute('title',couleur);           // info-bulle visible au survol
       satNode = satNode.nextSibling;              // sat = cellule suivante ligne 2
     }
   }
 </script>

 <h1>2. - tableau HSL variable</h1>
  <p>Déplacer le pointeur de la souris au-dessus du tableau</p>
 <table id="hsl2" class="hsl">
  <tr><td> </td><td colspan=5>hue</td></tr>
  <tr><td> </td><td colspan=5>saturation</td></tr>
  <tr><td>lum</td><td>100%</td><td>75%</td><td>50%</td><td>25%</td><td>0%</td></tr>
  <tr><td>100%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>87.50%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>75%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>62.5%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>50%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>37.5%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>25%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>12.5%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>0%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
 </table>
 <script>
  var hsl2 = document.getElementById('hsl2');    // table concernée
  colorhsl = function(table,hue,d=0) {
   var rows = table.getElementsByTagName('TR');    // lignes de la table
   if ( d ) rows[0].children[1].firstChild.nodeValue = 'hue = '+hue.toFixed(0)+'°';
   for ( var n = d+2; n < rows.length; n++ ) {       // boucle sur les lignes
     tr = rows[n];                                 // ligne courante
     var lum = tr.firstChild.firstChild.nodeValue; // lum = texte 1ère cellule
     var satNode = rows[d+1].firstChild.nextSibling; // sat = 2ème cellule 3ème ligne
     for ( var td = tr.childNodes[1]; td; td = td.nextSibling ) {
       var couleur = 'hsl('+hue+','+satNode.firstChild.nodeValue+','+lum+')';
       td.style.backgroundColor = couleur;         // couleur de la cellule
       td.setAttribute('title',couleur);           // info-bulle visible au survol
       satNode = satNode.nextSibling;              // sat = cellule suivante ligne 2
     }
   }
  };
  hsl2.addEventListener('mousemove', function(event){
    var dx = (event.layerX - hsl2.offsetLeft - hsl2.clientWidth/2);
    var dy = (event.layerY - hsl2.offsetTop - hsl2.clientHeight/2);
    var hue =180+ Math.atan2(dx,dy)*180/Math.PI;
    colorhsl(this,hue,1);
  });
 </script>

 <h1>3. - tableau HSL variable avec curseur artisanal</h1>
  <div id="pval" style="text-align: center">hue = 0°</div>
  <div style="position: relative; text-align: center;">
  <progress id="p" max="360" value="0" style="width: 360px"></progress>
  <span id="slider">&nbsp;</span><!-- cf style en zone CSS -->
  </div>
 
 <table id="hsl3" class="hsl">
  <tr><td> </td><td colspan=5>saturation</td></tr>
  <tr><td>lum</td><td>100%</td><td>75%</td><td>50%</td><td>25%</td><td>0%</td></tr>
  <tr><td>100%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>87.50%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>75%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>62.5%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>50%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>37.5%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>25%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>12.5%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>0%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
 </table>

 <script>
  var p = document.getElementById('p'),    // progress bar
   hsl3 = document.getElementById('hsl3'),
   slider = document.getElementById('slider'),
   dx;
  
  function updateSlider() {
    slider.style.left = (p.offsetLeft+p.value-6)+'px';
  }
  window.onresize = updateSlider;

  p.value = 0;
  updateSlider();

  p.parentNode.addEventListener('mousemove', changeHue);
  p.parentNode.addEventListener('mousedown', changeHue);

  function changeHue(event){
    if ( event.buttons != 1 ) return;
    if ( event.target == p ) {
      dx = (event.layerX - p.offsetLeft);
    }
    else if ( event.target == slider ) {
      dx = (event.layerX + slider.offsetLeft - p.offsetLeft);
    }
    dx = Math.max(Math.min(dx,360),0);
    document.getElementById('pval').innerHTML = 'hue = '+dx+'°';
    p.value = dx;
    colorhsl(hsl3,dx);
    updateSlider();
  }
 </script>

<div style="clear:both"></div><hr style="margin-top: 2.66em;">
<p style="margin-top:1.33em; text-align: center;">
 <a href="https://validator.w3.org/check?uri=referer"><img
    src="html5-badge-h-solo.png"
    title="Valid HTML 5"
    alt="Valid HTML 5"></a>
</p>

</body>
